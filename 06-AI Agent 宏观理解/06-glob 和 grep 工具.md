# Glob 和 Grep 工具的区别

## 为什么需要两个搜索工具？

Glob 和 Grep 解决**完全不同的问题**，不能互相替代。

## 核心区别

### Glob - 文件名/路径模式搜索

```typescript
// 根据文件名/路径模式找文件
pattern: "**/*.js" // 找所有 JS 文件（必需参数）
path: "src"(可选) // 搜索目录，不指定时默认为当前工作目录
```

**特点**：

- 只看文件名和路径
- 不读取文件内容
- 返回文件路径列表
- 速度极快（不需要打开文件）

**使用场景**：

- 想知道项目中有哪些 `.ts` 文件
- 想找到某个目录下的所有配置文件
- 想找到测试文件（`*.test.ts`）

---

### Grep - 文件内容正则搜索

```typescript
// 在文件内容中搜索代码模式
pattern: "function\s+\w+" // 找所有函数定义
pattern: "import.*React" // 找所有导入 React 的文件
pattern: "class\s+\w+.*extends" // 找所有继承类
```

**特点**：

- 读取每个文件的内容
- 用正则表达式匹配代码
- 返回文件路径 + 行号 + 匹配的行内容
- 比较慢（需要打开和读取文件）

**使用场景**：

- 找到所有调用 `console.log` 的地方
- 找到定义了某个函数的文件
- 找到所有包含特定关键词的代码

## 实际例子

假设你想找到项目中所有使用 `useState` 的 React 组件：

**❌ 只用 Glob**：

```
glob("**/*.tsx")  // 找到所有 TSX 文件，但不知道哪些用了 useState
```

**❌ 只用 Grep**：

```
grep("useState")  // 会在所有文件（包括 node_modules、build 目录）中搜索
```

**✅ 正确做法**：

```
glob("src/**/*.tsx")      // 先定位到源码目录的 TSX 文件
grep("useState", "src")   // 只在 src 目录中搜索
```

或者 Grep 支持的更高效方式：

```
grep("useState", path="src", include="*.tsx")  // 在 src 目录的 TSX 文件中搜索
```

## 技术实现对比

| 维度         | Glob                       | Grep                          |
| ------------ | -------------------------- | ----------------------------- |
| **搜索对象** | 文件名/路径                | 文件内容                      |
| **性能**     | 相对较快                   | 相对较慢（取决于文件数量）    |
| **开销**     | 只需遍历文件系统           | 需要打开并读取每个文件        |
| **返回信息** | 文件路径（按修改时间排序） | 文件路径 + 行号 + 代码片段    |
| **底层实现** | Ripgrep --files 模式       | Ripgrep -nH --regexp 正则搜索 |

## 为什么不能合并成一个？

如果把它们合并成一个工具，会导致：

1. **模糊的意图**：AI Agent 不知道你到底是要找文件名还是内容
2. **不必要的开销**：只是想找 `.js` 文件名，却要扫描所有文件内容
3. **复杂的使用体验**：一个参数既控制文件名模式又控制内容模式，容易混淆

## 设计哲学

**做一件事，做到极致**

- **Glob**：专注于快速找文件，基于文件名和路径模式
- **Grep**：专注于搜索代码内容，基于正则表达式

分工明确，各自优化，让 AI Agent 能精准选择合适的工具。

## 最佳实践

1. **先 Glob，后 Grep**：先用 Glob 缩小范围，再用 Grep 搜索内容
2. **利用 Grep 的 path 和 include 参数**：`grep("pattern", path="src", include="*.tsx")` 同时指定搜索目录和文件类型
3. **避免全项目 Grep**：尽量指定搜索路径，避免搜索 node_modules 等无关目录
